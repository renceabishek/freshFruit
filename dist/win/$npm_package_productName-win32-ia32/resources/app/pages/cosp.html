<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>BOSP Reports</title>

	
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	<script src="../vendor/jquery/jquery.js"></script>
	<script src="../js/jquery-3.2.1.min.js"></script>
	<script src="../js/lowdb.js"></script>
	<!--<script src="../js/schedules.js"></script>-->
	<script src="../js/vessel.js"></script>
	<script src="../js/country.js"></script>
	<script src="../js/port.js"></script>
	<script src="../js/fuel.js"></script>
	<script src="../js/fuelgrade.js"></script>
	<script src="../js/mailconfig.js"></script>
	<script src="../js/cosp.js"></script>
	<script src="../js/fuelcombi.js"></script>
	<script src="../js/rendered.js"></script>
	<script src="../js/mailaction.js"></script>
	<script src="../js/masterreport.js"></script>

	<script src="/path/to/shared/js/modernizr.com/Modernizr-2.5.3.forms.js"> </script>
	<script type="text/javascript">

          $(document).ready(function () {

          	

 			
          	
        var info = (db.get('vesselinfo').value());
        document.getElementById("span_vesselname").innerHTML=info[0].vslname;
        $('#cop_imonum').val(info[0].imodetails);
        setports();
        console.log('readylast');
        getFueldata();  
    });


          function setports(){
          	var myeosp = db.get('ports').value();
            var options = '';
        	console.log('size'+myeosp.length);
    	 	for (var i = 0; i < myeosp.length; i++){
    	 		   	options += '<option value="'+myeosp[i].portname+'~~'+myeosp[i].portcode+'" />';
    	 		   	
    	 			document.getElementById('portList').innerHTML = options;  
    	 	
			}
     
          }
          

    </script>

</head>
	<!-- Page Content -->

	<form id="bospform">
		<div id="page-content-wrapper">
			<div class="container-fluid">
				<div class="row">
					<div style="background:white;border: 1px solid #ffffff;box-shadow: 5px 5px 27px #8f8e8e;border-radius: 10px;margin:0 auto;Z-INDEX: 2000; margin-top: -15px;">
						
				<div class="col-sm-12" style="font-size:16px;color:#00b6e3;margin-top: 5px;font-weight:bold;background-color: darkblue !important;margin-top: 0px; color:white;padding:5px;border-radius:10px 10px 0 0">
				
					<div class="col-sm-3 text-left"  style="padding-top: 7px !important;"> BOSP Report </div>
					<div class="col-sm-6 text-center" >
	                	<span  maxlength="200" style="font-size: 25px !important;"  id="span_vesselname" readonly> 
	           	    </div> 
           		</div> 
						<div style="margin-top: 50px">
							<!--<div class="row">
								<div class="col-sm-12 col-md-8 col-lg-12">
									<div class="col-sm-2 text-right">Service
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										<input class="form-control" list="scheduleslist" id="cop_service" onblur="setVesselCode(this)" onchange="checkservice()" onclick="setSchedule()">
										<datalist id="scheduleslist" />
									</div>

									<div class="col-sm-2 text-right">Vessel Name
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2 ">
										<input class="form-control" id="cop_vslname" list="VesselList" onblur="setVesselCode(this)">
										<datalist id="VesselList" />
									</div>
									<div class="col-sm-2 text-right">Vessel Code
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										<input class="form-control" maxlength="10" id="cop_vslcode"> </div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<div class="col-sm-2 text-right">Voyage Number
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										<input id="cop_voynum" maxlength="10" class="form-control">
									</div>
									<div class="col-sm-2 text-right">Bound
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										<input id="cop_bound" maxlength="1" class="form-control">
									</div>
									<div class="col-sm-2"></div>
									<div class="col-sm-2"></div>
								</div>
							</div> 
							<div class="row">
								<div class="col-sm-12">
									<div class="col-sm-2 text-right">Master's Name</div>
									<div class="col-sm-2">
										<input class="form-control" maxlength="100" id="cop_mastername">
									</div>
									<div class="col-sm-2 text-right">IMO Number</div>
									<div class="col-sm-2">
										<input id="cop_imonum" maxlength="50" class="form-control">
									</div>
									<div class="col-sm-2 text-right">Call Sign</div>
									<div class="col-sm-2">
										<input class="form-control" maxlength="50" id="cop_callsign">
									</div>
								</div>
							</div> -->
							<div class="row">
								<div class="col-sm-12">
									<div class="col-sm-2 text-right">Departure
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										
										<input class="form-control" maxlength="150" id="cop_depport" list="portList" onchange="setArrPortCode()">
										<datalist id="portList" />
									</div>

									<!--<div class="col-sm-2 text-right">Country</div>
									<div class="col-sm-2">
										<input class="form-control" id="cop_country" maxlength="50" list="countylist" onblur="setCountryName(this)">
										<datalist id="countylist" />
									</div> -->

									<div class="col-sm-2 text-right">Unlocode
										<span class="required" style="color:red">&nbsp;*</span>
									</div>
									<div class="col-sm-2">
										<input class="form-control" maxlength="6" id="cop_unlocode">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<div class="col-sm-2 text-right">off set from UTC
										<span style="font-size: 10px;">(East +, West -)</div>
									<div class="col-sm-1" style=" padding-right: 0 !important;">
										<select class="form-control" id="cop_offset">
											<option>+</option>
											<option>-</option>
										</select>
									</div>

									<div class="col-sm-1">
										<input class="form-control" style="padding-right: 0 !important;" id="cop_offsetutc" onkeypress="return isTime(event)" onchange="validateTime(this);"
										 ondrop="return false;" onpaste="return false;" value="00:00" maxlength="5"> </div>

									<div class="col-sm-2 text-right">IMO Number</div>
									<div class="col-sm-2">
										<input id="cop_imonum" maxlength="50" readonly="true" class="form-control">
									</div>

								</div>
							</div>

							<div class="form-group">
								<div class="row">
									<div class="col-xs-12" style="margin-top:10px">
										<div class="section_header_top" style="height: 3px !important; width: 97%; margin-right: 0px;">
										</div>
										<div class="section_header">
											Time Stamp
										</div>
									</div>
								</div>
							</div>

						<div class="form-group">
								<div class="row">

									<div class="col-sm-12" style="margin-top: 10px;">
										<div class="col-sm-2 text-right">Pilot Away
											<span class="required" style="color:red"></span>
										</div>
										<div class="col-sm-2" style="padding-right:0px;">
											<input class="form-control" id="cop_pilotway" type="date">
										</div>
										<!-- <div class="col-sm-1 text-right">HH:MM</div> -->
										<div class="col-sm-1" style="padding-right:0px;">
											<input class="form-control" id="cop_pilotway1" style="" onkeypress="return isTime(event)" onchange="validateTime(this);"
											 ondrop="return false;" onpaste="return false;" value="00:00" maxlength="5">
										</div>
									</div>

									<div class="col-sm-12">
										<div class="col-sm-2 text-right">BOSP Date
											<span class="required" style="color:red">&nbsp;*</span>

										</div>
										<div class="col-sm-2" style="padding-right:0px;">
											<input class="form-control" id="cop_cosp" type="date"> </div>
										<div class="col-sm-1" style="padding-right:0px;">
											<input class="form-control" style="" id="cop_cosp1" onkeypress="return isTime(event)" onchange="validateTime(this);" ondrop="return false;"
											 onpaste="return false;" value="00:00" maxlength="5">
										</div>

										<div class="col-sm-1 text-right">
											<td>BOSP Position </span>
										</div>
										<div class="col-sm-2" style="padding-right:0px;">
											<input class="form-control" id="cop_posistion">
										</div>
										<div class="col-sm-2">
											<input class="form-control" id="cop_posistion1">
										</div>
									</div>


									<div class="col-xs-12" style="margin-top:10px;margin-bottom:15px;">
										<div class="section_header_top" style="height: 3px !important; width: 97%; margin-right: 0px;">
										</div>
										<div class="section_header">
											Next Port Details
										</div>
									</div>
									<br/>

									<div class="col-sm-12">
										<div class="col-sm-2 text-right">Next Port
											<span class="required" style="color:red">
										</div>
										<div class="col-sm-3" style="padding-right:0px;">
											<input class="form-control" id="cop_nxtport" list="portList" onblur="setArrPortCode2(this)">
										</div>
										<div class="col-sm-1 text-right">Country
											<span class="required" style="color:red">
										</div>
										<div class="col-sm-3">
											<input class="form-control" id="cop_country1" style="width:106%" list="countylist" onblur="setCountryName1(this)">
										</div>
										<div class="col-sm-1 text-right">Unlocode
											<span class="required" style="color:red"></span>
										</div>
										<div class="col-sm-2" style="">
											<input class="form-control" id="cop_nnolocode1">
										</div>
									</div>


									<div class="col-sm-12">
										<div class="col-sm-2 text-right">distance to go
											<span style="font-size: 10px;">(NM)
												<span style="font-size: 10px;"> (BOSP to P/stn)</span>
										</div>
										<div class="col-sm-3" style="padding-right:0px;">
											<input class="form-control rit-align" id="cop_disttogo" onkeypress="return isNumber(event)" onchange="return validateDecimal(this)"
											 ondrop="return false;" onpaste="return false;" value=0.00>
										</div>

										<div class="col-sm-1 text-right">Expected Cons
											<span style="font-size: 10px;">(MT)</span>
										</div>
										<div class="col-sm-3">
											<input class="form-control rit-align" style="width:106%" id="cop_excons" onkeypress="return isNumber(event)" onchange="return validateDecimal(this)"
											 ondrop="return false;" onpaste="return false;" value=0.00>
										</div>

										<div class="col-sm-1 text-right">Set RPM</div>
										<div class="col-sm-2">
											<input class="form-control rit-align" id="cop_setrpm" onkeypress="return isNumber(event)" onchange="return validateDecimal(this)"
											 ondrop="return false;" onpaste="return false;" value=0.00>
										</div>

									</div>

									<div class="col-sm-12">
										<div class="col-sm-2 text-right">Off Set From UTC
											<span style="font-size: 10px;">(East +, West -)</span>
										</div>
										<div class="col-sm-1" style="padding-right:0px;">
											<select class="form-control" id="cop_offset1">
												<option>+</option>
												<option>-</option>
											</select>
										</div>

										&nbsp;
										<div class="col-sm-1" style="padding-right:0px;">
											<input class="form-control" style="" id="cop_offsetutc1" onkeypress="return isTime(event)" onchange="validateTime(this);"
											 ondrop="return false;" onpaste="return false;" value="00:00" maxlength="5">
										</div>

										<div class="col-sm-2 text-right">ETA Next Port
											<span class="required" style="color:red"></span>
										</div>
										<div class="col-sm-2" style="padding-right:0px;">
											<input class="form-control" id="cop_etanextport" type="date">
										</div>
										<div class="col-sm-1" style="padding-right:0px;">
											<input class="form-control" id="cop_etanextport1" onkeypress="return isTime(event)" onchange="validateTime(this);" ondrop="return false;"
											 onpaste="return false;" value="00:00" maxlength="5"> </div>

										<!-- <div class="col-sm-1"> </div> -->
									</div>
									<div class="col-sm-12">
									</div>

								</div>
								<!-- /.row -->
								<div class="form-group">
									<div class="row">
										<div class="col-xs-12" style="margin-top:10px">
											<div class="section_header_top" style="height: 3px !important; width: 97%; margin-right: 0px;">
											</div>
											<div class="section_header">
												Fuel Details
											</div>


										</div>
									</div>
								</div>

								<div class="row">
			<div class="col-sm-12" style="padding:18px; width:99%; margin-left:7px;">
                <div class="panel panel-info highlighter">
                <div class="panel-body" style="padding:6px">
              <table id="porttable" class="table table-bordered" style="margin-left:8px;">
                    <thead>
                         <tr>
                            <th class="text-center">FUEL TYPE</th>
                            <th class="text-center">ME CONSP<span style="font-size: 10px;"> (MT) (Since last report)</span> </th>
                            <th class="text-center">AE CONSP<span style="font-size: 10px;">(MT)</span>
								<span style="font-size: 10px;">(Since last report)</span></th>
                            <th class="text-center"> BOILER CONSP<span style="font-size: 10px;">(MT)</span>
								<span style="font-size: 10px;">(Since last report)</span>  </th>
                            <th class="text-center">  TOTAL CONSP<span style="font-size: 10px;"> (MT)</span></th>
                            <th class="text-center"> BROB at 'BOSP'<span style="font-size: 10px;">(MT)</span> </th>
                         </tr>
                    </thead>
                     <tbody >
                        

                    </tbody>
                </table>
				
               
            </div>

            </div>
			</div>
		</div>

		<!-- /.row -->
		<div class="row">
			<div class="col-lg-12" style="padding:0 30px">
				<div class="form-group">
					<div class="row">
						<div class="section_header_top" style="height: 3px !important; width: 97%; margin-right: 0px;">
						</div>
						<div class="section_header">
						Remarks
						</div>
					</div>
				</div>
				<div class="panel-body">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<tbody>
								<tr>
									<td>
										<textarea class="form-control1" maxlength="500" rows="14" cols="50" id="cop_remarks"></textarea>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
		</div>
		<br/>
							<!-----------/buttons-------------->
							<!-- /.row -->
		<div class="form-group">

							<div class="col-lg-12" style="text-align: right;">
								<button type="button" class="btn btn-success" onclick="return sendActionJson()"> <i class="fa fa-paper-plane-o"> </i> Send</button>
								<button type="button" class="btn btn-danger" onclick="resetCOSPAction()"> <i class="fa fa-undo"> </i> Reset</button>
							</div>
						</div>

						<br/>
						<br/>
	</form>
	<div class="modal fade" id="modalCompose">
		<div class="modal-dialog" style="width: 636px">
			<div class="modal-content">
				<div class="modal-header modal-header-info">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
					<h4 class="modal-title">
						<span class="glyphicon glyphicon-envelope"></span> Compose Mail</h4>
				</div>
				<div class="modal-body">
					<form role="form" class="form-horizontal">
						<div class="form-group">
							<label class="col-sm-2" for="inputFrom">
								<span class="glyphicon glyphicon-user"></span>From</label>
							<div class="col-sm-10">
								<input type="email" class="form-control" id="inputFrom">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2" for="inputTo">
								<span class="glyphicon glyphicon-user"></span>To</label>
							<div class="col-sm-10">
								<input type="email" class="form-control" id="inputTo">
							</div>
						</div>
						 <div class="form-group">
                            <label class="col-sm-2" for="ccTo">
                                <span class="glyphicon glyphicon-user"></span>CC</label>
                            <div class="col-sm-10">
                                <input type="email" class="form-control" id="ccTo">
                            </div>
                        </div>
						<div class="form-group">
							<label class="col-sm-2" for="inputSubject">
								<span class="glyphicon glyphicon-list-alt"></span>Subject</label>
							<div class="col-sm-10">
								<input type="text" class="form-control" id="inputSubject" placeholder="subject">
							</div>
						</div>

						<div class="form-group">
							<label class="no-space-break col-sm-2" for="inputAttach">
								<span class="fa fa-paperclip"></span>Attachment</label>
							<div class="col-sm-10">
								<input type="text" class="form-control" id="inputAttach" readonly>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2" for="inputBody">
								<span class="glyphicon glyphicon-list"></span>text</label>
							<div class="col-sm-10">
								<div class="table-responsive" >
                            	  	<table class="table table-striped table-bordered table-hover">
                            	  		<tbody>
												<tr>
													<td>
														<textarea class="form-control1" style="background-color: #eeeeee !important" maxlength="500" rows="3" id="inputBody"></textarea>
													</td>
												</tr>
										</tbody>
                                	</table>
                                </div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" onclick="MailAction('bospform')">Send
						<i class="fa fa-arrow-circle-right fa-lg"></i>
					</button>
				</div>
			</div>
		</div>
		<div class="hide-Progress-overlay show-Progress-overlay">
			<div class="glassPane">
				<div class="progress-bar">
					<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
					<span class="sr-only">Loading...</span>
					<!--md-progress-circle mode="indeterminate" color="primary"></md-progress-circle-->
				</div>
			</div>
		</div>
	</div>
	</div>
	<script type="text/javascript">


		function SaveSend() {
			if ($('#cop_service').val() != "") {
				lowdbAction("savesend");
			}
			else {
				alert("Kindly Select the Values");
			}
		}		
	</script>

	<script type="text/javascript">

		function resetCOSPAction(){
			document.getElementById('bospform').reset();
	    	var info = (db.get('vesselinfo').value());
	    	$('#cop_imonum').val(info[0].imodetails);
		}

	function setSchedule(){		
		if(schedules1.length==0){
         alert("Kindly add the schedule");
     }
	}
		function lowdbvalidation() {
			if ($('#cop_service').val() != "") {
				lowdbAction("save");
			}
			else {
				alert("Kindly Select the values");
			}
		}

		function lowdbAction(type) {

			

			var obj = { "service": $('#cop_service').val(), "vesselname": $('#cop_vslname').val(), "vesselcode": $('#cop_vslcode').val(), "voyagenumber": $('#cop_voynum').val(), "bound": $('#cop_bound').val(), "masters name": $('#cop_mastername').val(), "imonumber": $('#cop_imonum').val(), "callsign": $('#cop_callsign').val(), "departure": $('#cop_depport').val(), "country": $('#cop_country').val(), "unlocode": $('#cop_unlocode').val(), "offsetfromutc": $('#cop_offset').val() }
			

			db.get('cosp').push(obj).write();
			db.update('count', n => n + 1).write();
			var size = (db.get("cosp").size().value());
			var value = (db.get('cosp').nth(size - 1).value());
			db1.get('maildata').nth(0).assign(value).value();
			db1.write();

			var maximum = 100000;
         	var minimum = 100;
         	var randomnumber = Math.floor(Math.random() * (maximum - minimum + 1)) + minimum;
          	document.getElementById("inputSubject").value = "BOSP Report"+randomnumber+".json";
 			document.getElementById("inputAttach").value = "BOSP Report"+randomnumber+".json";
			
			if (type == "savesend") {
				$('#modalCompose').modal('show');
				var maildetail = (db.get('sysconfig').value());
				$("#inputFrom").val(maildetail[0].from);
				$("#inputTo").val(maildetail[0].to);
				$("#ccTo").val(maildetail[0].vesselemail);
				$('#inputBody').val($('#cop_remarks').val());
			}
			else {
				alert("Successfully Saved");
				document.getElementById("bospform").reset();
			}
		}

		function checkservice() {
			array = db.get('cosp').value();
			console.log(array);
			if ($('#cop_service').val() != "") {
				var schedule = [];
				var searchschedule = $('#cop_service').val() + "~~" + $('#cop_bound').val() + "~~" + $('#cop_voynum').val() + "~~" + $('#cop_vslcode').val() + "~~" + $('#cop_vslname').val() + "~~" + $('#cop_unlocode').val() + "~~" + $('#cop_imonum').val();
				for (var i = 0; i < array.length; i++) {
					console.log(array[i]);
					schedule[i] = array[i]['service'] + "~~" + array[i]['bound'] + "~~" + array[i]['voyagenumber'] + "~~" + array[i]["vesselcode"] + "~~" + array[i]["vesselname"] + "~~" + array[i]["unlocode"] + "~~" + array[i]["imonumber"];
				}
				console.log(schedule);
				for (var i = 0; i < schedule.length; i++) {
					console.log(schedule[i]);
					console.log(searchschedule);
					if (schedule[i] == searchschedule) {
						var retVal = confirm("Schedule already Exists,Do you want to Continue");
						if (retVal == true) {
							return true;
						}
						else {
							document.getElementById("bospform").reset();
							return false;
						}
						break;
					}
				}
			}
		}
	</script>

	<script type="text/javascript" src="../../shared/js/html5Forms.js" data-webforms2-support="date" data-webforms2-force-js-validation="true"
	 data-webforms2-force-js-date-picker="true" data-lang="en">
	</script>

	<!-- /#wrapper -->

	<!-- jQuery -->
	<script src="../vendor/jquery/jquery.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

	<!-- Metis Menu Plugin JavaScript -->
	<script src="../vendor/metisMenu/metisMenu.min.js"></script>


	<!-- Custom Theme JavaScript -->
	<script src="../dist/js/sb-admin-2.js"></script>

	</body>

</html>